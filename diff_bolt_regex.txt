diff --git a/src/modules/spam_analyzer.py b/src/modules/spam_analyzer.py
index cca4a49..af756fc 100644
--- a/src/modules/spam_analyzer.py
+++ b/src/modules/spam_analyzer.py
@@ -38,15 +38,17 @@ class SpamAnalyzer:
     ]

     # Pre-compiled regex patterns for performance
+    SPAM_KEYWORD_REGEXES = [re.compile(p, re.IGNORECASE) for p in SPAM_KEYWORDS]
     COMBINED_SPAM_PATTERN = re.compile('|'.join(SPAM_KEYWORDS), re.IGNORECASE)
+
     LINK_PATTERN = re.compile(r'https?://', re.IGNORECASE)
     URL_EXTRACTION_PATTERN = re.compile(r'https?://[^\s<>"]+')
-    MONEY_PATTERN = re.compile(r'\$\d+|\d+\s*(dollar|usd|euro)')
+    MONEY_PATTERN = re.compile(r'\$\d+|\d+\s*(dollar|usd|euro)', re.IGNORECASE)
     IMG_TAG_PATTERN = re.compile(r'<img\b', re.IGNORECASE)
     HIDDEN_TEXT_PATTERN = re.compile(r'font-size:\s*[0-2]px|color:\s*#fff.*background.*#fff', re.IGNORECASE)
     EMAIL_ADDRESS_PATTERN = re.compile(r'[\w\.-]+@[\w\.-]+')
-    SENDER_DOMAIN_PATTERN = re.compile(r'[\w\.-]+@([\w\.-]+)')
-    DISPLAY_NAME_PATTERN = re.compile(r'^([^<]+)<')
+    SENDER_DOMAIN_PATTERN = re.compile(r'[\w\.-]+@([\w\.-]+)', re.IGNORECASE)
+    DISPLAY_NAME_PATTERN = re.compile(r'^([^<]+)<', re.IGNORECASE)

     # Suspicious URL patterns
     SUSPICIOUS_URL_PATTERNS = [
@@ -57,23 +59,13 @@ class SpamAnalyzer:
         re.compile(r'[a-z0-9\-]{30,}'),  # Very long subdomain/path
     ]

-    # Pre-compiled regex patterns
-    MONEY_REGEX = re.compile(r'\$\d+|\d+\s*(dollar|usd|euro)', re.IGNORECASE)
-    LINK_REGEX = re.compile(r'https?://', re.IGNORECASE)
-    IMG_TAG_REGEX = re.compile(r'<img\b', re.IGNORECASE)
-    HIDDEN_TEXT_REGEX = re.compile(r'font-size:\s*[0-2]px|color:\s*#fff.*background.*#fff', re.IGNORECASE)
-    URL_EXTRACT_REGEX = re.compile(r'https?://[^\s<>"]+', re.IGNORECASE)
-    EMAIL_REGEX = re.compile(r'[\w\.-]+@[\w\.-]+')
-    SENDER_EMAIL_REGEX = re.compile(r'[\w\.-]+@([\w\.-]+)', re.IGNORECASE)
-    DISPLAY_NAME_REGEX = re.compile(r'^([^<]+)<', re.IGNORECASE)
-
-    # Compile suspicious URL patterns
-    # SUSPICIOUS_URL_PATTERNS contains compiled regex objects, so we extract their patterns for the combined pattern.
-
     # Pre-compiled combined pattern for performance
     # To join them, we need the pattern strings
     COMBINED_URL_PATTERN = re.compile('|'.join(p.pattern for p in SUSPICIOUS_URL_PATTERNS), re.IGNORECASE)

+    # Additional shorteners specific check regex
+    SHORTENER_PATTERN = re.compile(r'(bit\.ly|tinyurl|t\.co|goo\.gl)', re.IGNORECASE)
+
     def __init__(self, config):
         """
         Initialize spam analyzer
@@ -167,14 +159,12 @@ class SpamAnalyzer:

         # Check spam keywords
         if self.COMBINED_SPAM_PATTERN.search(subject_lower):
-            # We use search here because we just want to know if ANY exist, but iterating
-            # the original list to find WHICH one might be slow if list is long.
-            # However, for detailed reporting we need to know which one.
-            # Since the original list is short (8 items), we can iterate.
-            for pattern in self.SPAM_KEYWORDS:
-                if re.search(pattern, subject_lower):
+            # Optimization: Use pre-compiled regexes
+            # We iterate to find exactly which keyword matched for reporting
+            for pattern_re, pattern_str in zip(self.SPAM_KEYWORD_REGEXES, self.SPAM_KEYWORDS):
+                if pattern_re.search(subject_lower):
                     score += 1.5
-                    indicators.append(f"Spam keyword in subject: {pattern}")
+                    indicators.append(f"Spam keyword in subject: {pattern_str}")

         # Check for numbers indicating money
         if self.MONEY_PATTERN.search(subject_lower):
@@ -247,21 +237,19 @@ class SpamAnalyzer:
                 parsed = urlparse(url)
                 domain = parsed.netloc

-                # Check against suspicious patterns
-                for pattern in self.SUSPICIOUS_URL_PATTERNS:
-                    if pattern.search(domain):
-                        score += 0.5
-                        suspicious.append(url)
-                        break
+                # Check against combined suspicious patterns first
+                if self.COMBINED_URL_PATTERN.search(domain):
+                     # If matched, we just mark it. The original code broke after first match
+                     # in the loop, effectively counting only one match per URL from this list.
+                     score += 0.5
+                     suspicious.append(url)

                 # Check for URL shorteners
-                if any(shortener in domain for shortener in ['bit.ly', 'tinyurl', 't.co', 'goo.gl']):
+                # Original code logic was separate and could add another 0.5 score
+                if self.SHORTENER_PATTERN.search(domain):
                     score += 0.5
                     suspicious.append(url)

-                # Check for mismatched display text and actual URL
-                # This would require more context from HTML parsing
-
             except Exception:
                 pass
