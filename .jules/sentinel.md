## 2025-05-24 - [Media File Processing Bypass Prevention]
**Vulnerability:** The deepfake detection module previously processed files with dangerous extensions (e.g., `.exe` disguised as `.mp4`) or files where the declared content type mismatched the actual file content (Magic Bytes). This could lead to writing malicious files to disk and processing them with `cv2`, potentially exposing the system to parser vulnerabilities.
**Learning:** Checking file extensions is not enough. We must ensure that files identified as dangerous or suspicious by other layers (like extension checks or magic byte analysis) are strictly excluded from further processing steps like deepfake analysis.
**Prevention:** Modified `MediaAuthenticityAnalyzer.analyze` to explicitly skip `_check_deepfake_indicators` if `ext_score` or `mismatch_score` indicates a high threat (>= 5.0).
